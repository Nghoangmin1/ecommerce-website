@model IEnumerable<Fahasa.Models.Address>

@{
    ViewData["Title"] = "Sổ địa chỉ";
}

<div class="container py-5">
    <div class="row">
        <!-- Sidebar Menu -->
        <!-- Sidebar Menu -->
        <partial name="_CustomerAccountSidebar" />

        <!-- Content -->
        <div class="col-md-9">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="text-uppercase font-weight-bold mb-0">Sổ địa chỉ</h5>
                <a asp-action="Create" class="btn btn-outline-danger btn-sm">
                    <i class="bi bi-plus-lg"></i> Thêm địa chỉ mới
                </a>
            </div>
            
            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success alert-dismissible fade show">
                    @TempData["Success"]
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                </div>
            }

            @if (!Model.Any())
            {
                <div class="text-center py-5 bg-white shadow-sm rounded">
                    <i class="bi bi-geo-alt text-muted" style="font-size: 3rem;"></i>
                    <p class="mt-3 mb-0">Bạn chưa có địa chỉ nào.</p>
                </div>
            }
            else
            {
                <div class="row">
                    @foreach (var item in Model)
                    {
                        <div class="col-12 mb-3">
                            <div class="card border-0 shadow-sm @(item.IsDefault ? "border-danger border" : "")" style="@(item.IsDefault ? "border-left: 5px solid #dc3545 !important;" : "")">
                                <div class="card-body position-relative">
                                    <div class="row">
                                        <div class="col-md-8">
                                            <h6 class="font-weight-bold">
                                                @item.ReceiverName
                                                @if (item.IsDefault)
                                                {
                                                    <span class="badge badge-success ml-2 font-weight-normal"><i class="bi bi-check-circle-fill"></i> Mặc định</span>
                                                }
                                            </h6>
                                            <p class="text-muted small mb-1">Địa chỉ: @item.StreetAddress, @item.Ward, @item.District, @item.City</p>
                                            <p class="text-muted small mb-0">Điện thoại: @item.PhoneNumber</p>
                                        </div>
                                        <div class="col-md-4 text-right d-flex flex-column justify-content-center align-items-end">
                                            <div class="btn-group btn-group-sm">
                                                <a asp-action="Edit" asp-route-id="@item.Id" class="text-primary mr-3 text-decoration-none">Chỉnh sửa</a>
                                                 @if (!item.IsDefault)
                                                {
                                                     <form asp-action="Delete" asp-route-id="@item.Id" method="post" class="d-inline" onsubmit="return confirm('Bạn có chắc muốn xóa địa chỉ này?');">
                                                        <button type="submit" class="btn btn-link text-danger p-0 text-decoration-none small">Xóa</button>
                                                    </form>
                                                }
                                            </div>
                                            @if (!item.IsDefault)
                                            {
                                                <form asp-action="SetDefault" asp-route-id="@item.Id" method="post" class="mt-2">
                                                    <button type="submit" class="btn btn-outline-secondary btn-sm py-0" style="font-size: 0.8rem;">Đặt làm mặc định</button>
                                                </form>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }


        </div>
    </div>
</div>
